# cd ~/project_gitlab && find scripts/ -type f -exec sops --decrypt --in-place {} \;
# cd ~/project_gitlab && find secrets/ -type f -exec sops --decrypt --in-place {} \;

# 1) Order of rules goes from top to bottom.
# 2) Also rules has to be specific, not general, cause only first rule matching
# 3) .sops.yaml has to be inside root folder of your project
# aws everywhere for a case of accidental remove of local private keys(it's happened once!)
#-------------------------------------------------------------------------------------------------------------
# ADMIN: bootstrap secrets (S3 backend, full SA, root SSH)          >>> only for full control / owner
# OPS  : operational secrets (CI/CD, Ansible, viewer SA, certs)     >>> for pipelines and limited human access
# DEV  : env-specific secrets for development services              >>> scoped to dev usage only
# PROD : env-specific secrets for production services               >>> strictly for production runtime

creation_rules:
  # ğŸ” Admin
  - path_regex: ^secrets/admin/.*$
    encrypted_regex: '.*'
    key_groups:
      - age:
          - age1pdjzu9ezfcl44wxdl6wad62pm3u2zshl8easgslsff3x0zyxjfeqjz2qwh
  # ğŸ” CI 
  - path_regex: ^secrets/ops/.*$
    encrypted_regex: '.*'
    key_groups:
      - age:
          - age1qkh7zef3lfrg09hfwgdf364ml9cxx4axp7ka0vvgcqffrewh8u6stngks0
  # ğŸ” Dev
  - path_regex: ^secrets/dev/.*$
    encrypted_regex: '.*'
    key_groups:
      - age:
          - age1xstmrg0se0f5awzat6nelmy0ckndxxpx2zxc2mvlx6ps6kyvkv6qh67mv6
  # ğŸ” Prod
  - path_regex: ^secrets/prod/.*$
    encrypted_regex: '.*'
    key_groups:
      - age:
          - age1asjrd3206mvw5pwlwhn3aajh4ty6wfjaqmt4zs7ulc7k5mlqk9wskxy0au
  - path_regex: ^scripts/send_vars_to_gitlab.sh
    encrypted_regex: '.*'
    key_groups:
      - age:
          - age1sgrucltyqyjnvvqlz5rmkn72gyt90xadggeedrxeh2yrg92epewsh3gypt
        # kms:
        #   - arn: arn:aws:kms:eu-north-1:590184089880:key/8b991131-2f94-4ab9-9d17-859a7f4d15b3
